
<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Carrinho</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
<h2>Carrinho</h2>
<div id="user"></div>
<div id="cart"></div>
<div id="rewards"></div>

<script>
const API = "https://vintage-production.up.railway.app";
const token = localStorage.getItem("vw_token");

function getCart(){
  return JSON.parse(localStorage.getItem("vw_cart")||"[]");
}

async function api(path){
  const r = await fetch(API+path,{
    headers:{Authorization:"Bearer "+token}
  });
  return r.json();
}

(async()=>{
  const me = await api("/user/me");
  document.getElementById("user").innerHTML =
    "<b>"+me.name+"</b><br>"+me.email;

  const cart = getCart();
  document.getElementById("cart").textContent =
    "Itens: " + cart.length;

  const bal = await api("/bonus/balance");
  document.getElementById("rewards").textContent =
    JSON.stringify(bal.available,null,2);
})();
</script>
</body>
</html>
